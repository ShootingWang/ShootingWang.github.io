---
title: 数据分析 | 数据包络分析
date: 2020-11-16 22:22:21
tags: 数据分析
categories: 数据分析
math: true
mathjax: true
mermaid: true
hide: true
notshow: true
---

<center>DEA</center>
<!--more-->


# 数据包络分析
数据包络分析是针对多投入和多产出的问题，利用线性规划的方法，对具有可比性的同类型单位进行相对有效性评价的一种数量分析方法。是A.Charnes，W.W.Copper和E.Rhodes在1978年提出的评价多指标输入输出、衡量系统有效性的方法。
- 数据包络分析（DEA）可以用于解决**多指标问题**。

一些概念：
- 决策单元（DMU）：效率评价的对象，可以理解为一个将一定“投入”转化为一定“产出”的实体
- 技术效率：在保持决策单元投入不变的情况下，实际产出同理想产出的比值
- 规模报酬：
  - 规模报酬不变（-）：生产要素同时增加一倍，产量的增加也正好是一倍
  - 规模报酬递增（irs）：生产要素同时增加一倍，产量的增加多于一倍
  - 规模报酬递减（drs）：生产要素同时增加一倍，产品的增加少于一倍
- **DEA强有效**：
  - 任何一项投入的数量都无法减少，除非减少产出的数量或增加其他至少一种投入的数量
  - 任何一项产出的数量都无法增加，除非增加投入的数量或减少其他至少一种产出的数量
- **DEA弱有效**：
  - 无法等比例减少各项投入的数量，除非减少产出的数量
  - 无法等比例增加各项产出的数量，除非增加投入的数量
  - 这种情况下，虽然不能等比例减少投入或增加产出，但某一项或某几项（非全部）投入可能减少
- 生产前沿面：对于给定的生产要素和产出价格，选择要素投入的最优组合和产出的最优组合，即投入成本最小、产出收益最大的组合，其所对应的生产函数所描述的生产可能性边界就是生产前沿面
> 设 $\omega>0, \mu>0, L= \left\{ (X,Y)| \mu^TX- \omega^T Y=0  \right\}$满足$T \subset \left\{ (X,Y)|\mu^TX-\omega^T Y \geq 0 \right\}$，$L \cap T\neq \emptyset$，则称$L$为生产可能集$T$的有效面，称$L\cap T$为生产前沿面。
- $T$不一定等于$L$，$T\leq L$

假设共有$n$个决策单元（DMU），每个决策单元都有$m$种输入和$r$种输出。
- $X_j=\left(x_{j1}, \cdots, x_{ji}, \cdots, x_{jm}\right)^T$为第$j$个DMU的输入向量。其中，$x_{ji}$表示第$j$个DMU的第$i$种输入。
- $Y_j=\left(y_{j1}, \cdots, y_{js}, \cdots, y_{jr}\right)^T$为第$j$个DMU的输出向量。其中，$y_{js}$表示第$j$个DMU的第$s$种输出。
- $u=(u_1,u_2,\cdots,u_m)$为投入的权值向量
- $v=(v_1,v_2,\cdots,v_r)$为产出的权值向量


数据包络分析有多种模式：
- CCR模式
- BCC模式
- 交叉模式
- A&P模式

## 效益分析
- **综合技术效益**（OE，Overall Efficiency）：反映决策单元在一定投入要素的生产效率，是对决策单元的资源配置能力、资源使用效率等多方面能力的综合衡量与评价
  - OE = 1：表示该决策单元的投入产出是综合有效的，即同时技术有效和规模有效
- **技术效益**（TE，Technical Efficiency）：企业由于管理和技术等因素影响的生产效率
- **规模效益**（SE，Scale Efficiency）：由于企业规模因素影响的生产效率
  - TE = 1 且 SE < 1：表示在目前的技术水平上，其投入资源的使用是有效的，未能达到综合有效的根本原因在于其规模无效，因此其改革的重点在于如何更好地发挥其规模效益

三者满足以下关系：
$$OE = TE \times SE$$

- CCR模式得到的是OE
- BCC模式得到的是TE


# CCR模型
CCR模型是最早被提出来的数据包络分析方法
- 本质：线性规划
- CCR分别代表三个作者的名字首字母
- CCR模式下DEA效率评估模型所得到的最优解$OE_k$是第$k$个决策单元的“综合技术效益”

 {% note warning %}
定义：第$k$个决策单元的效益评价指数为
$$e_k=\frac{u^TX_k}{v^TY_k}$$
$k = 1, 2, \cdots, n$.
{% endnote %}

从投入资源的角度来看，在当前产出的水准下，比较投入资源的使用情况，以此作为效益评价的依据，此种模式称为**投入导向模式**。

CCR模式的数学模型可表示为：对$k=1,2,\cdots,n$，有
\begin{equation}
\begin{aligned}
\max &\quad \frac{v^TY_k}{u^TX_k} \\
s.t. & \quad \left\{
\begin{array}{ll}
\frac{v^TY_j}{u^TX_j} \leq 1 & ,\quad j=1,2,\cdots,n.\\
u>0,v>0 & 
\end{array}
\right.
\end{aligned}
\end{equation}

- 因为现实中的任何一项技术都不能使得输入全部转化为输出，所以$\frac{ v^T Y_j }{ u^T X_j } \leq 1$
- 分式规划的缺点：解释不唯一——如果$u,v$是解，则$ku,kv$也是解（$k$是任意非零常数）
 - 为了解决这个问题，通常令目标函数的分母$u^T X_k=1$或者通过Charnes-Cooper变换将分式规划变为线性规划

Charnes-Cooper变换：
令$ \mu = tu, \omega = tv, t = \frac{1}{u^T X_k}$，则上述数学模型变为：
\begin{equation}
\begin{aligned}
\max & \quad \omega^T Y_k \\
s.t. & \quad \left\{
\begin{array}{ll}
\mu^T X_k - \omega^T Y_k \geq 0 & ,\quad j=1,2,\cdots,n.\\
\mu^T X_k = 1 & \\
\mu > 0, \omega > 0 & 
\end{array}
\right.
\end{aligned}
\end{equation}

> 详细过程如下：
> 因为$\mu = tu > 0, \omega = tv > 0, t = \frac{1}{u^TX_k} \Rightarrow \mu^T = tu^T, \omega^T = tv^T, tu^TX_k = 1$，则
$$\max\quad \frac{v^TY_k}{u^TX_k} \Rightarrow \max \quad \frac{tv^TY_k}{tu^TX_k} \Rightarrow \max \quad \omega^TY_k$$
\begin{aligned}
& \quad \frac{v^TY_k}{u^TX_k}\leq 1\\
\Rightarrow & \quad u^TX_k - v^TY_k \geq 0\\
\Rightarrow & \quad \frac{1}{t}\mu^TX_k - \frac{1}{t}\omega^TY_K \geq 0\\
\Rightarrow & \quad \mu^TX_k - \omega^TY_k \geq 0
\end{aligned}
因为$t=\frac{1}{u^TX_k}$，则
$$t=\frac{1}{u^TX_k} \Rightarrow tu^TX_k = 1 \Rightarrow \mu^TX_k = 1$$


{% note default %}
对于任何一个线性规划模型，都存在一个等价的对偶模型。
原始模型：
\begin{equation}
\begin{aligned}
\max & \quad c^Tx^\prime\\
s.t. & \quad \left\{
\begin{array}{l}
Ax^\prime\leq b\\
x^\prime \geq 0
\end{array}
\right.
\end{aligned}
\end{equation}
对偶模型：
\begin{equation}
\begin{aligned}
\min & \quad b^Ty^\prime\\
s.t. & \quad \left\{
\begin{array}{l}
A^Ty^\prime \geq c\\
y^\prime \geq 0
\end{array}
\right.
\end{aligned}
\end{equation}
{% endnote %}

记
\begin{equation}
\begin{aligned}
c_{(m+r)\times1} &= \left(0,\cdots,0, y_{k1}, \cdots, y_{kr} \right)^T \\
x^\prime_{(m+r)\times1} &= \left(\mu_1,\cdots,\mu_m, \omega_1,\cdots,\omega_r \right)^T\\
A_{(n+1)\times(m+r)} &= \left(
\begin{array}{cccccc}
-x_{11} & \cdots & -x_{1m} & y_{11} & \cdots & y_{1r} \\
\vdots & \ddots & \vdots & \vdots  & \ddots & \vdots  \\
-x_{n1} & \cdots & -x_{nm} & y_{n1} & \cdots & y_{nr} \\
x_{k1}& \cdots & x_{km}& 0       & \cdots & 0
\end{array}
\right) \\
b_{(n+1)\times1} &= \left(0,\cdots,0,1\right)^T \\
y^\prime &= \left(\lambda_1,\cdots,\lambda_n, \theta \right)^T
\end{aligned}
\end{equation}

则
$$\max \quad c^Tx^\prime \Rightarrow \max \quad \omega^TY_k$$
$$Ax^\prime \leq b \Rightarrow -\mu^TX_k + \omega^TY_k \leq 0, \mu^TX_k = 1$$
$$\min \quad b^Ty^\prime \Rightarrow \min\quad \theta$$
\begin{aligned}
& \quad A^Ty^\prime \geq c \\
\Rightarrow & \quad \left\{
\begin{array}{l}
\lambda_1x_{11} + \lambda_2x_{21} + \cdots + \lambda_nx_{n1} \leq \theta x_{k1}\\
\vdots\\
\lambda_1x_{1m} + \lambda_2x_{2m} + \cdots + \lambda_nx_{nm} \leq \theta x_{km}\\
\lambda_1y_{11} + \lambda_2y_{21} + \cdots + \lambda_ny_{n1} \geq y_{k1}\\
\vdots\\
\lambda_1y_{1r} + \lambda_2y_{2r} + \cdots + \lambda_ny_{nr} \geq y_{kr}
\end{array}
\right.
\end{aligned}

则CCR模式的数学模型的对偶形式如下：
\begin{aligned}
\min & \quad \theta \\
s.t. & \left\{
\begin{array}{l}
\sum_{j=1}^n \lambda_jX_j \leq \theta X_k\\
\sum_{j=1}^n \lambda_jY_j \leq Y_k\\
\lambda_j \geq 0, \quad j = 1,2,\cdots,n.
\end{array}
\right.
\end{aligned}


# BCC模式

# 交叉模式


# 参考资料
- [数据包络分析--CCR模型](https://blog.csdn.net/qq_41228463/article/details/108310361)
- [数据包络分析法（DEA）——CCR](https://zhuanlan.zhihu.com/p/73096903)
- [DEA (数据包络分析)介绍及 python3 实现](https://zhuanlan.zhihu.com/p/60853027)